/****************************************************
* Author : Sandeep Kumar
* Date : 24 Oct, 2017
* Description : It tests below mentioned classes
* -> InquisiumToSalesforceEmailParser
* -> SyncSurveyFromInquisium_WebService
* -> Cevent_WebService_Helper
****************************************************/
@isTest(seeAllData=false) 
public class InquisiumToSalesforceEmailParser_Test { 
    private static Opportunity opp;
    private static Account acc; 
    private static Contact con;
    private static EB_SB_Builder__c EBSBRec;
    private static Professional_Services_Project__c PSP;
    private static Messaging.InboundEmail email; 
    private static Messaging.InboundEnvelope env;
    private static InquisiumToSalesforceEmailParser InquisiumSurveyParserClass;        
    private static User depUser = [Select Id, ProfileId from User where Name = 'CRM Deployment User'];  
    private static Id userProfieId = UserProfileUtil.getProfileIDByName('Customer Care Rep - Product Consultant EB Team');   
    
    @testSetup
    public static void testData(){
        // Create Account Record.
        acc = TestUtil.createAccount('Test Account', 'Biz_Ac');
        insert acc;     
        
        // Create Contact Record.
        con = TestUtil.createContact(acc.id);
        insert con;   
        
        // Create PSP Record.
        Professional_Services_Project__c PSPRec = new Professional_Services_Project__c();
        PSPRec.Account__c = acc.Id;
        PSPRec.of_EB__c = 0;
        insert PSPRec;  
        
        opp = TestUtil.createOpportunity('testOpp','Event','Bid Phase');
        opp.Contact_Associated__c = con.Id;
        opp.AccountId = acc.Id;
        opp.CloseDate = Date.today().addDays(80);
        insert opp;
        
    }
    
    // Close loop testing for the survey originated from Case object.
    public static testMethod void caseObjectResponse(){
        
        Id recTypeCase = RecordTypeUtil.getRecordTypeIDByDevName('Case','New_Event');
        Case caseObj = new Case();
        caseObj.recordTypeId = recTypeCase ;
        caseObj.Status = 'Open';
        caseObj.Minutesoncase__c = 30; 
        caseObj.AccountId = [Select Id From Account Where Name = 'Test Account'].Id;
        caseObj.subject='Test Hosp Cloud Implementation Survey';
        caseObj.Origin ='Email';       
        caseObj.description='The details of Francisco De Asis Grageras response are below.';
        insert caseObj;
        
        // Below code tests the Response number with EB SB Project.
        InquisiumSurveyParserClass = new InquisiumToSalesforceEmailParser(); 
        email = new Messaging.InboundEmail();
        env = new Messaging.InboundEnvelope();    
        email.subject = 'Tell us how did we do';
        email.htmlBody = '<span style="font-size: 11pt; font-family: Arial, Helvetica, sans-serif; width: 600px; color: #000; font-weight: bold;">The details of Sandeep Kumar\'s response are below.<br /></span><table width="590" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif;"><tr><td><br /></td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="590"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Contact Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">First Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Sandeep</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Last Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Kumar</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Source ID:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">'+caseObj.Id+'</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Email Address:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">sandeepk@cvent.com</td></tr></table><br /><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Respondent Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Survey Title:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">TEST - SF - Client Services Satisfaction Survey</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Response Number:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">60874230</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Start Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:18 AM</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Completion Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:19 AM</td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Response Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"><b>Question</b></td> <td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> <B>Answer</B></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Considering everything about your most recent interaction with Customer Support, please rate your overall satisfaction with the service you received.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please choose which most influenced your rating:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to understand the issue</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Which product did you contact us about most recently?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Event Management</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Has your question or issue been resolved?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Yes</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> How many times did you contact our support regarding your most recent question or issue?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">1 time</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> The organization made it easy for me to handle my issue.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Agree</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your level of satisfaction with the following aspects of this support experience:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to Understand the Issue: Satisfied<br />Professionalism: Satisfied<br />Ability to Keep Commitments: Satisfied<br />The Issue being Resolved: Satisfied<br />Consultative Approach: Satisfied<br />Knowledge: Satisfied<br />Ease of Contacting Support: Satisfied<br />Communication: Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your overall satisfaction with the product.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent\'s capabilities meet my requirements.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent is easy to use.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr></table><img src="http://www.cvent.com/api/email/dispatch/v1/open/l95nlvynv82r5p/qx47948p/transparent.gif"/>';
        email.toAddresses = new String[]{'code.tester@test-ind.com'};    
        // Call method to test
        InquisiumSurveyParserClass.handleInboundEmail(email,env);
    }
    
    // Close loop testing for the survey originated from Onsite Solution object.
    public static testMethod void onsiteSolutionObjectResponse(){
        // Get the AllianceTech RecordTypeId
        Id recTypeAllianceTech  = RecordTypeUtil.getRecordTypeIDByDevName('Alliance_OA_Projects__c','Alliance_Tech') ;
         
        Alliance_OA_Projects__c onsiteProjectObj = new Alliance_OA_Projects__c();
        onsiteProjectObj.RecordTypeId = recTypeAllianceTech;
        insert onsiteProjectObj;
        
        // Below code tests the Response number with EB SB Project.
        InquisiumSurveyParserClass = new InquisiumToSalesforceEmailParser(); 
        email = new Messaging.InboundEmail();
        env = new Messaging.InboundEnvelope();    
        email.subject = 'Tell us how did we do';
        email.htmlBody = '<span style="font-size: 11pt; font-family: Arial, Helvetica, sans-serif; width: 600px; color: #000; font-weight: bold;">The details of Sandeep Kumar\'s response are below.<br /></span><table width="590" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif;"><tr><td><br /></td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="590"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Contact Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">First Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Sandeep</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Last Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Kumar</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Source ID:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">'+onsiteProjectObj.Id+'</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Email Address:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">sandeepk@cvent.com</td></tr></table><br /><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Respondent Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Survey Title:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">TEST - SF - Client Services Satisfaction Survey</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Response Number:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">60874230</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Start Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:18 AM</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Completion Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:19 AM</td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Response Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"><b>Question</b></td> <td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> <B>Answer</B></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Considering everything about your most recent interaction with Customer Support, please rate your overall satisfaction with the service you received.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please choose which most influenced your rating:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to understand the issue</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Which product did you contact us about most recently?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Event Management</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Has your question or issue been resolved?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Yes</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> How many times did you contact our support regarding your most recent question or issue?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">1 time</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> The organization made it easy for me to handle my issue.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Agree</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your level of satisfaction with the following aspects of this support experience:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to Understand the Issue: Satisfied<br />Professionalism: Satisfied<br />Ability to Keep Commitments: Satisfied<br />The Issue being Resolved: Satisfied<br />Consultative Approach: Satisfied<br />Knowledge: Satisfied<br />Ease of Contacting Support: Satisfied<br />Communication: Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your overall satisfaction with the product.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent\'s capabilities meet my requirements.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent is easy to use.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr></table><img src="http://www.cvent.com/api/email/dispatch/v1/open/l95nlvynv82r5p/qx47948p/transparent.gif"/>';
        email.toAddresses = new String[]{'code.tester@test-ind.com'};    
        // Call method to test
        InquisiumSurveyParserClass.handleInboundEmail(email,env);  
        
        // Create a Success Record in LogsWarehouse Object
        InquisiumToSalesforceEmailParser.StoreStatusInLogsWarehouse(onsiteProjectObj.Id,'Success',email.htmlBody);
    }
    
    // Close loop testing for the survey originated from Bundle Card Item object.
    public static testMethod void BundleCardItemObjectResponse(){
        // Create Bundle Card Record 
        Bundle_Card__c bundleCardobjectObj = new Bundle_Card__c();
        bundleCardobjectObj.Account__c = [Select Id From Account Where Name = 'Test Account'].Id;    
        bundleCardobjectObj.Contact__c = [Select Id From Contact Where Account.Name ='Test Account'].Id;
        insert bundleCardobjectObj;
        
        // Create Bundle Card Item Record  and associate it with the Bundle Card
        Bundle_Card_Item__c bundleCrdItemObj = new Bundle_Card_Item__c();
        bundleCrdItemObj.Bundle_Card__c = bundleCardobjectObj.Id;
        bundleCrdItemObj.Listing_Start_Date__c = Date.today().addDays(30);
        insert bundleCrdItemObj;
        
        // Below code tests the Response number with EB SB Project.
        InquisiumSurveyParserClass = new InquisiumToSalesforceEmailParser(); 
        email = new Messaging.InboundEmail();
        env = new Messaging.InboundEnvelope();    
        email.subject = 'Tell us how did we do';
        email.htmlBody = '<span style="font-size: 11pt; font-family: Arial, Helvetica, sans-serif; width: 600px; color: #000; font-weight: bold;">The details of Sandeep Kumar\'s response are below.<br /></span><table width="590" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif;"><tr><td><br /></td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="590"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Contact Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">First Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Sandeep</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Last Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Kumar</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Source ID:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">'+bundleCrdItemObj.Id+'</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Email Address:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">sandeepk@cvent.com</td></tr></table><br /><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Respondent Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Survey Title:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">TEST - SF - Client Services Satisfaction Survey</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Response Number:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">60874230</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Start Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:18 AM</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Completion Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:19 AM</td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Response Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"><b>Question</b></td> <td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> <B>Answer</B></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Considering everything about your most recent interaction with Customer Support, please rate your overall satisfaction with the service you received.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please choose which most influenced your rating:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to understand the issue</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Which product did you contact us about most recently?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Event Management</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Has your question or issue been resolved?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Yes</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> How many times did you contact our support regarding your most recent question or issue?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">1 time</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> The organization made it easy for me to handle my issue.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Agree</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your level of satisfaction with the following aspects of this support experience:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to Understand the Issue: Satisfied<br />Professionalism: Satisfied<br />Ability to Keep Commitments: Satisfied<br />The Issue being Resolved: Satisfied<br />Consultative Approach: Satisfied<br />Knowledge: Satisfied<br />Ease of Contacting Support: Satisfied<br />Communication: Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your overall satisfaction with the product.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent\'s capabilities meet my requirements.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent is easy to use.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr></table><img src="http://www.cvent.com/api/email/dispatch/v1/open/l95nlvynv82r5p/qx47948p/transparent.gif"/>';
        email.toAddresses = new String[]{'code.tester@test-ind.com'};    
        // Call method to test
        InquisiumSurveyParserClass.handleInboundEmail(email,env);
    }
    
    // Close loop testing for the survey originated from Survey Header object.
    public static testMethod void surveyHeaderObjectResponse(){
        // Create Survey Header Record 
        Survey_Header__c surveyHeaderObj = new Survey_Header__c();
        surveyHeaderObj.Account__c = [Select Id From Account Where Name = 'Test Account'].Id;    
        surveyHeaderObj.Contact__c = [Select Id From Contact Where Account.Name ='Test Account'].Id;
        surveyHeaderObj.Survey_Type__c = 'Passkey';
        insert surveyHeaderObj;
        
        // Below code tests the Response number with EB SB Project.
        InquisiumSurveyParserClass = new InquisiumToSalesforceEmailParser(); 
        email = new Messaging.InboundEmail();
        env = new Messaging.InboundEnvelope();    
        email.subject = 'Tell us how did we do';
        email.htmlBody = '<span style="font-size: 11pt; font-family: Arial, Helvetica, sans-serif; width: 600px; color: #000; font-weight: bold;">The details of Sandeep Kumar\'s response are below.<br /></span><table width="590" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif;"><tr><td><br /></td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="590"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Contact Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">First Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Sandeep</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Last Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Kumar</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Source ID:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">'+surveyHeaderObj.Id+'</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Email Address:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">sandeepk@cvent.com</td></tr></table><br /><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Respondent Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Survey Title:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">TEST - SF - Client Services Satisfaction Survey</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Response Number:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">60874230</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Start Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:18 AM</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Completion Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:19 AM</td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Response Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"><b>Question</b></td> <td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> <B>Answer</B></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Considering everything about your most recent interaction with Customer Support, please rate your overall satisfaction with the service you received.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please choose which most influenced your rating:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to understand the issue</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Which product did you contact us about most recently?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Event Management</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Has your question or issue been resolved?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Yes</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> How many times did you contact our support regarding your most recent question or issue?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">1 time</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> The organization made it easy for me to handle my issue.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Agree</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your level of satisfaction with the following aspects of this support experience:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to Understand the Issue: Satisfied<br />Professionalism: Satisfied<br />Ability to Keep Commitments: Satisfied<br />The Issue being Resolved: Satisfied<br />Consultative Approach: Satisfied<br />Knowledge: Satisfied<br />Ease of Contacting Support: Satisfied<br />Communication: Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your overall satisfaction with the product.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent\'s capabilities meet my requirements.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent is easy to use.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr></table><img src="http://www.cvent.com/api/email/dispatch/v1/open/l95nlvynv82r5p/qx47948p/transparent.gif"/>';
        email.toAddresses = new String[]{'code.tester@test-ind.com'};    
        // Call method to test
        InquisiumSurveyParserClass.handleInboundEmail(email,env);
    }
    
    // Close loop testing for the survey originated from Bundle Card Item object.
    public static testMethod void OnboardingObjectResponse(){
        // Create Onboarding Record
        Onboarding__c onboardingObj = new Onboarding__c();
        onboardingObj.RecordTypeId = RecordTypeUtil.getRecordTypeIDByDevName('Onboarding__c', 'Passkey_Hotel_Existing_Integration');
        onboardingObj.Account_Name__c = [Select Id From Account Where Name = 'Test Account'].Id;    
        insert onboardingObj;
        
        // Below code tests the Response number with EB SB Project.
        InquisiumSurveyParserClass = new InquisiumToSalesforceEmailParser(); 
        email = new Messaging.InboundEmail();
        env = new Messaging.InboundEnvelope();    
        email.subject = 'Tell us how did we do';
        email.htmlBody = '<span style="font-size: 11pt; font-family: Arial, Helvetica, sans-serif; width: 600px; color: #000; font-weight: bold;">The details of Sandeep Kumar\'s response are below.<br /></span><table width="590" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif;"><tr><td><br /></td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="590"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Contact Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">First Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Sandeep</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Last Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Kumar</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Source ID:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">'+onboardingObj.Id+'</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Email Address:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">sandeepk@cvent.com</td></tr></table><br /><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Respondent Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Survey Title:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">TEST - SF - Client Services Satisfaction Survey</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Response Number:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">60874230</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Start Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:18 AM</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Completion Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:19 AM</td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Response Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"><b>Question</b></td> <td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> <B>Answer</B></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Considering everything about your most recent interaction with Customer Support, please rate your overall satisfaction with the service you received.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please choose which most influenced your rating:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to understand the issue</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Which product did you contact us about most recently?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Event Management</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Has your question or issue been resolved?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Yes</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> How many times did you contact our support regarding your most recent question or issue?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">1 time</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> The organization made it easy for me to handle my issue.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Agree</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your level of satisfaction with the following aspects of this support experience:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to Understand the Issue: Satisfied<br />Professionalism: Satisfied<br />Ability to Keep Commitments: Satisfied<br />The Issue being Resolved: Satisfied<br />Consultative Approach: Satisfied<br />Knowledge: Satisfied<br />Ease of Contacting Support: Satisfied<br />Communication: Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your overall satisfaction with the product.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent\'s capabilities meet my requirements.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent is easy to use.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr></table><img src="http://www.cvent.com/api/email/dispatch/v1/open/l95nlvynv82r5p/qx47948p/transparent.gif"/>';
        email.toAddresses = new String[]{'code.tester@test-ind.com'};    
        // Call method to test
        InquisiumSurveyParserClass.handleInboundEmail(email,env);
    }
    
    // Close loop testing for the survey originated from Bundle Card Item object.
    public static testMethod void MobileAppObjectResponse(){
        // Create Onboarding Record
        Mobile_Card__c mobileAppObj = new Mobile_Card__c();
        mobileAppObj.RecordTypeId = Schema.SObjectType.Mobile_Card__c.getRecordTypeInfosByDeveloperName().get(Label.Mobile_App_RT_Label_Name).getRecordTypeId();
        mobileAppObj.Contract_Account_New__c = [Select Id From Account Where Name = 'Test Account'].Id;    
        mobileAppObj.Request_Type__c = 'App Build Plus';
        insert mobileAppObj;
        
        // Below code tests the Response number with EB SB Project.
        InquisiumSurveyParserClass = new InquisiumToSalesforceEmailParser(); 
        email = new Messaging.InboundEmail();
        env = new Messaging.InboundEnvelope();    
        email.subject = 'Tell us how did we do';
        email.htmlBody = '<span style="font-size: 11pt; font-family: Arial, Helvetica, sans-serif; width: 600px; color: #000; font-weight: bold;">The details of Sandeep Kumar\'s response are below.<br /></span><table width="590" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif;"><tr><td><br /></td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="590"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Contact Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">First Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Sandeep</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Last Name:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Kumar</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Source ID:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">'+mobileAppObj.Id+'</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Email Address:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">sandeepk@cvent.com</td></tr></table><br /><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Respondent Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Survey Title:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">TEST - SF - Client Services Satisfaction Survey</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Response Number:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">60874230</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Start Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:18 AM</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="180" align="right" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Completion Date:</td><td width="410" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">10/26/2017 3:19 AM</td></tr></table><br /><table border="0" cellspacing="0" cellpadding="3" style="font-size:10pt; font-family: Arial, Helvetica, sans-serif; border-collapse: collapse;" width="600"><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td colspan="2" style="background-color:gray;color:white; border: 1px solid #cccccc;"><b>Response Information</b></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"><b>Question</b></td> <td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> <B>Answer</B></td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Considering everything about your most recent interaction with Customer Support, please rate your overall satisfaction with the service you received.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please choose which most influenced your rating:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to understand the issue</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Which product did you contact us about most recently?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Event Management</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Has your question or issue been resolved?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Yes</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> How many times did you contact our support regarding your most recent question or issue?</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">1 time</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> The organization made it easy for me to handle my issue.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Agree</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your level of satisfaction with the following aspects of this support experience:</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Ability to Understand the Issue: Satisfied<br />Professionalism: Satisfied<br />Ability to Keep Commitments: Satisfied<br />The Issue being Resolved: Satisfied<br />Consultative Approach: Satisfied<br />Knowledge: Satisfied<br />Ease of Contacting Support: Satisfied<br />Communication: Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Please rate your overall satisfaction with the product.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">Very Satisfied</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent\'s capabilities meet my requirements.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr><tr style="font-size:10pt;font-family: Arial, Helvetica, sans-serif; background-color: #fff;"><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;"> Cvent is easy to use.</td><td width="295" align="left" valign="top" style="background-color: #fff; border: 1px solid #cccccc;">6</td></tr></table><img src="http://www.cvent.com/api/email/dispatch/v1/open/l95nlvynv82r5p/qx47948p/transparent.gif"/>';
        email.toAddresses = new String[]{'code.tester@test-ind.com'};    
        // Call method to test
        InquisiumSurveyParserClass.handleInboundEmail(email,env);
    }
}